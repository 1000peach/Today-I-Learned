# 01. ë¦¬ë•ìŠ¤ ë¯¸ë“¤ì›¨ì–´ ì‘ì„±

1. ë¦¬ë•ìŠ¤ ë¯¸ë“¤ì›¨ì–´ëŠ” í•˜ë‚˜ì˜ í•¨ìˆ˜ -> í•¨ìˆ˜ë¥¼ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜
2. íë¦„ : **action -> middleware1 -> (next) -> middleware2 -> (next) -> Reducer -> store**
   * nextëŠ” ë¯¸ë“œì›¨ì–´ê°€ actionì„ ë°›ì•„ì™”ì„ ë•Œ ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ì—ê²Œ ì „ë‹¬í•˜ëŠ” í•¨ìˆ˜ (ë¯¸ë“¤ì›¨ì–´ë¥¼ í•œ ê°œ ì´ìƒ ì‚¬ìš©í•  ìˆ˜ ìˆê¸° ë•Œë¬¸)
   * ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ê°€ ì—†ë‹¤ë©´ nextë¥¼ í†µí•´ Reducerì—ê²Œ actionì„ ì „ë‹¬
   * ì¦‰, ë¯¸ë“¤ì›¨ì–´ ë‚´ë¶€ì—ì„œ nextë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ íŠ¹ì • actionì„ ë¬´ì‹œ -> Reducerê¹Œì§€ ì „ë‹¬ì´ ì•ˆ ë¨
   * í˜¸ì¶œ ë°©ë²• : `next(action);`
3. ë¯¸ë“¤ì›¨ì–´ ì¤‘ê°„ì—ì„œ ìƒˆë¡œìš´ actionì„ dispatchí•˜ë©´ ì²˜ìŒìœ¼ë¡œ ëŒì•„ê° (ìƒˆë¡œ ì „ë‹¬)
4. ë¯¸ë“¤ì›¨ì–´ ì•ˆì—ì„œ `getState` ì‚¬ìš© ì‹œ ì–´ë–¤ ìƒíƒœë¥¼ ì§€ë‹ˆê³  ìˆëŠ” ì§€ í™•ì¸í•  ìˆ˜ ìˆìŒ

## âœ ì‚¬ìš© ë°©ë²•
* **arrow function**
```javascript
const middleware = store => next => action => {
    // í•˜ê³ ì‹¶ì€ ì‘ì—…
}
```
* **function**
```javascript
fuction middleware(store) { // ì¼ë‹¨ store(ì¸ìŠ¤í„´ìŠ¤)ë¥¼ ì¸ìë¡œ ë°›ìŒ -> subscribe, dispatch ì¡´ì¬
    return function (next) { // í•¨ìˆ˜ë¥¼ ë°˜í™˜. actionì„ ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ì—ê²Œ ì „ë‹¬
        return fuction (action) {
            // ì¸ìë¡œ action ê°ì²´ë¥¼ ë°›ìŒ
            // í•˜ê³ ì‹¶ì€ ì‘ì—…
        }
    }
}
```
* ë§Œì•½ `Promise`ë¥¼ returní•˜ë©´ `Promise`ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆìŒ
  * `return Promise.resolve();`

## ğŸ’¬ ì˜ˆì œ ì¼ë¶€

1. **src/middlewares/myLogger.js**
   * Counter í”„ë¡œê·¸ë¨ì—ì„œ action ì²˜ë¦¬ ì „ state, ì²˜ë¦¬ í›„ stateë¥¼ ì¶œë ¥í•˜ëŠ” ë¯¸ë“¤ì›¨ì–´ ì˜ˆì œ
   * actionì€ [+], [-] ë²„íŠ¼ì„ í´ë¦­í–ˆì„ ë•Œ ê°’ì„ ì¦ê°
```javascript
const myLogger = (store) => (next) => (action) => {
    console.log("Prev: \t", store.getState()); // action ì²˜ë¦¬ ì „ ìƒíƒœ ì¶œë ¥
    
    console.log(action); // actionì´ ì‹¤í–‰ë  ë•Œ consoleì— ì¶œë ¥
	
    console.log("Next: \t", store.getState()); // action ì²˜ë¦¬ í›„ ìƒíƒœ ì¶œë ¥
	
    const result = next(action); // actionì„ ë‹¤ìŒ ë¯¸ë“¤ì›¨ì–´ê°€ ìˆë‹¤ë©´ ë¯¸ë“¤ì›¨ì–´ì—ê²Œ, ì—†ë‹¤ë©´ ë¦¬ë“€ì„œì—ê²Œ ì „ë‹¬
	return result; // containersì—ì„œ dispatch ëì„ ë•Œ ê·¸ ê²°ê³¼
};
```
* ì˜ˆë¥¼ ë“¤ì–´ Counter ê°’ì´ 0ì¼ ë•Œ, [+] ë²„íŠ¼ í´ë¦­ ì‹œ `0`, `action.type`, `1`ì´ ì°¨ë¡€ëŒ€ë¡œ `console`ì— ì¶œë ¥ë¨
  
2. **src/index.js**
   * ë¦¬ë•ìŠ¤ ë¯¸ë“¤ì›¨ì–´ë¥¼ ì‚¬ìš©í•˜ê¸° ìœ„í•´ `createStore`ì˜ ë§ˆì§€ë§‰ ì¸ìë¡œ `applyMiddleware(myLogger)`ë¥¼ ì¶”ê°€
```javascript
import ReactDOM from "react-dom";
import "./index.css";
import App from "./App";
import * as serviceWorker from "./serviceWorker";
import { Provider } from "react-redux";
import { createStore, applyMiddleware } from "redux";
import rootReducer from "./modules";
import myLogger from "./middlewares/myLogger";

const store = createStore(rootReducer, applyMiddleware(myLogger));

ReactDOM.render(
	<React.StrictMode>
		<Provider store={store}>
			<App />
		</Provider>
	</React.StrictMode>,
	document.getElementById("root")
);
```

## ğŸ”— ì°¸ê³ 
* [11-01. ë¦¬ë•ìŠ¤ í”„ë¡œì íŠ¸ ì¤€ë¹„](https://github.com/1000peach/React-Study/tree/master/11.%20Redux%20Middleware/11-02.%20%EB%A6%AC%EB%8D%95%EC%8A%A4%20%ED%94%84%EB%A1%9C%EC%A0%9D%ED%8A%B8%20%EC%A4%80%EB%B9%84/src) : Reduxë¡œ Counter êµ¬í˜„í•œ ì˜ˆì œì—ì„œ ì¶”ê°€