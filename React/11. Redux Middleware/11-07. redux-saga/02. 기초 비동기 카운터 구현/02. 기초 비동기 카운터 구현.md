# 02. ê¸°ì´ˆ ë¹„ë™ê¸° ì¹´ìš´í„° êµ¬í˜„

1. 1ì´ˆ ë’¤ì— ê°’ì´ ë³€í•˜ëŠ” ë¹„ë™ê¸° ì¹´ìš´í„°ë¥¼ redux-sagaë¡œ êµ¬í˜„
2. sagaëŠ” reducerì²˜ëŸ¼ actionì„ dispatch í•˜ê¸° ìœ„í•œ reducerë¥¼ ë§Œë“œëŠ” ëŠë‚Œ
3. saga Generator = thunk creatorì™€ ìœ ì‚¬
   * saga actionì„ dispatchí•˜ë©´ ì•ˆì—ì„œ ì²˜ë¦¬í•œ reducer actionì— dispatch ë¨!
   * ex) `onClick={dispatch(increateAsync())}`
  
## ğŸ’¬ ì˜ˆì œ ì¼ë¶€

> **src/modules/counter.js**
```javascript
import { delay, put, takeEvery, takeLatest } from "redux-saga/effects";

const INCREASE = "counter/INCRESE";
const DECREASE = "counter/DECREASE";

// saga action
const INCREASE_ASYNC = "counter/INCREASE_ASYNC";
const DECREASE_ASYNC = "counter/DECREASE_ASYNC";

export const increase = () => ({ type: INCREASE });
export const decrease = () => ({ type: DECREASE });

export const increaseAsync = () => ({
	type: INCREASE_ASYNC
}); // ìˆœìˆ˜ ê°ì²´ ë°˜í™˜

export const decreaseAsync = () => ({
	type: DECREASE_ASYNC
});

function* increaseSaga() {
	yield delay(1000);
	// yield : redux ë¯¸ë“¤ì›¨ì–´ì—ê²Œ íŠ¹ì • ì‘ì—…ì„ ëª…ë ¹ -> effectë¥¼ yield
	yield put(increase());
	// put : dispatchì™€ ìœ ì‚¬. increase dispatchë¥¼ ì‹¤í–‰í•˜ë„ë¡ redux-sagaì—ê²Œ ëª…ë ¹
} // saga generator = redux-thunk creator ìœ ì‚¬ 

function* decreaseSaga() {
	yield delay(1000);
	yield put(decrease());
}

export function* counterSaga() {
	yield takeEvery(INCREASE_ASYNC, increaseSaga); // default
	yield takeLatest(DECREASE_ASYNC, decreaseSaga);
	// takeLatest : ê°€ì¥ ë§ˆì§€ë§‰ì— ë“¤ì–´ì˜¨ ê²ƒë§Œ actionë§Œ ì²˜ë¦¬
	// takeLeading : ë§¨ ì²˜ìŒì— ë“¤ì–´ì˜¨ action ì²˜ë¦¬, ì´í›„ actionì€ ë¬´ì‹œ
}
// íŠ¹ì • actionì´ dispatch ë˜ë©´ í•´ë‹¹ ì œë„ˆë ˆì´í„° ì‹¤í–‰ì„ ì—°ê²°
// ë§¤ë²ˆ í•„ìˆ˜ ì‘ì—… : ì—¬ëŸ¬ sagaë¡œ root saga ìƒì„±

const initState = 0;

export default function counter(state = initState, action) {
	switch (action.type) {
		case INCREASE:
			return state + 1;
		case DECREASE:
			return state - 1;
		default:
			return state;
	}
}

```
* 1ì´ˆ í›„ `increase()`ì™€ `decrease()`ë¥¼ ì‹¤í–‰í•˜ì—¬ ì¹´ìš´í„° ê°’ì„ ì„¤ì •í•˜ëŠ” `increaseSaga`, `decreaseSaga` ìƒì„±

> **src/modules/index.js**
```javascript
import { combineReducers } from "redux";
import counter, { counterSaga } from "./counter";
import posts from "./posts";
import { all } from "redux-saga/effects";

const rootReducer = combineReducers({ counter, posts });

export function* rootSaga() {
	yield all([counterSaga()]);
}

export default rootReducer;
```
* `all` import í›„ root saga ìƒì„±

> **src/index.js**
```javascript
import React from "react";
import ReactDOM from "react-dom";
import "./index.css";
import App from "./App";
import * as serviceWorker from "./serviceWorker";
import { Provider } from "react-redux";
import { createStore, applyMiddleware } from "redux";
import rootReducer, { rootSaga } from "./modules";
import logger from "redux-logger";
import { composeWithDevTools } from "redux-devtools-extension";
import ReduxThunk from "redux-thunk";

import createSagaMiddleware from "redux-saga";

const sagaMiddleware = createSagaMiddleware();

const store = createStore(
	rootReducer,
	composeWithDevTools(applyMiddleware(ReduxThunk, sagaMiddleware, logger))
); // store saga ë“±ë¡

sagaMiddleware.run(rootSaga);

ReactDOM.render(
	<React.StrictMode>
		<Provider store={store}>
			<App />
		</Provider>
	</React.StrictMode>,
	document.getElementById("root")
);

serviceWorker.unregister();
```
* storeì— `saga` ë“±ë¡. redux-thunk ë“±ê³¼ ê°™ì´ ìˆì„ ë•Œ ìˆœì„œëŠ” ìƒê´€ ì—†ìŒ
* `sagaMiddleware.run()` íŒŒë¼ë¯¸í„°ë¡œ root saga ë“±ë¡ (í˜¸ì¶œ X)