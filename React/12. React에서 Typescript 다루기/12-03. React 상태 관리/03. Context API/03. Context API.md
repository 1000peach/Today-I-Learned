# 03. Context API (Typescript Ver.)

1. context type, default value, gerneric ì„¤ì • í›„ ì‚¬ìš© ê°€ëŠ¥
2. stateê°€ nullì¼ ë•Œ ì»´íŒŒì¼ ì—ëŸ¬ -> throw error ì²˜ë¦¬í•´ì•¼ í•¨
   * stateê°€ nullì¼ ìˆ˜ ìˆë‹¤ëŠ” ê²½ê³ 

## ğŸ“ ì‚¬ìš© ì˜ˆì‹œ
```typescript
ìš°ë¦¬ê°€ ê°–ê³ ì‹¶ì€ ê°’  | null -> contextë¥¼ genericìœ¼ë¡œ ì„¤ì •í•´ì„œ ë§Œë“œëŠ” ê²ƒ.
// contextì— ëŒ€í•œ type ì •ì˜
type FooValue = {
  foo: number;
};

const FooContext = createContext<FooValue | null>(null);
// context generic ì„¤ì • : createContext<type | null>(defaultValue) 
```

## ğŸ‘©â€ğŸ’» Contextë¥¼ ì‚¬ìš©í•œ ê°’ ë³€ê²½(í´ë¦­) reducer ì˜ˆì œ
1. [reducer ì‘ì—…](https://github.com/1000peach/React-Study/blob/master/12.%20React%EC%97%90%EC%84%9C%20Typescript%20%EB%8B%A4%EB%A3%A8%EA%B8%B0/12-03.%20React%20%EC%83%81%ED%83%9C%20%EA%B4%80%EB%A6%AC/02.%20useReducer.md)
2. context ì„¤ì •
   * `SampleStateContext` : state ê´€ë¦¬
   * `SampleDispatchContext` : dispatch ê´€ë¦¬
3. reducerì™€ contextë¥¼ ì—°ê²°í•´ Provider ì„¤ì •
   * `SampleProvider` : children props type ì„¤ì • -> `SampleProviderProps`
4. contextì— ì ‘ê·¼í•˜ëŠ” custom hook ìƒì„±
   * `useSampleState`, `useSampleDispatch` : nullì¼ ë•Œ throw error

### 1. src/SampleContext.tsx
```typescript
/* SampleContext.tsx */

import { useContext, createContext, Dispatch, useReducer } from "react";

... state, action ì„¤ì •

// 1. state ê´€ë¦¬ context
const SampleStateContext = createContext<State | null>(null);

// 2. dispatch ê´€ë¦¬ context
type SampleDispatch = Dispatch<Action>; // DispatchëŠ” Action generic í•„ìš”
const SampleDispatchContext = createContext<SampleDispatch | null>(null); // genericìœ¼ë¡œ Dispatch(SampleDispatch) í•„ìš” (ë¶„ë¦¬ -> ê°€ë…ì„±)

type SampleProviderProps = {
  children: React.ReactNode;
};

export function SampleProvicer({ children }: SampleProviderProps) {
  const [state, dispatch] = useReducer(reducer, {
    count: 0,
    text: "hello",
    color: "red",
    isGood: true
  });

  return (
    // value = state, value = dispatch .. provider ì„¤ì •
    <SampleStateContext.Provider value={state}>
      <SampleDispatchContext.Provider value={dispatch}>{children}</SampleDispatchContext.Provider>
    </SampleStateContext.Provider>
  );
}

// context ì‚¬ìš© custom hook ì„¤ì •
export function useSampleState() {
  const state = useContext(SampleStateContext);
  if (!state) throw new Error("Cannot find SampleProvider"); // state null ì²´í¬ -> throw error
  return state;
}
export function useSampleDispatch() {
  const dispatch = useContext(SampleDispatchContext);
  if (!dispatch) throw new Error("Cannot find SampleProvider");
  return dispatch;
}
```

### 2. src/ReducerSample.tsx
```typescript
/* ReducerSample.tsx */

import { useSampleState, useSampleDispatch } from "./SampleContext";

function ReducerSample() {
  const state = useSampleState(); // state return
  const dispatch = useSampleDispatch(); // dispatch return

  const setCount = () => dispatch({ type: "SET_COUNT", count: 5 });

  ...

  return (
    <div>
      <p>
        <code>count: </code> {state.count}
      </p>
        ...
      <div>
        <button onClick={setCount}>SET_COUNT</button>
        ...
      </div>
    </div>
  );
}

export default ReducerSample;
```
## ğŸ”— ì°¸ê³ 
* [12-03-02. useReducer](https://github.com/1000peach/React-Study/blob/master/12.%20React%EC%97%90%EC%84%9C%20Typescript%20%EB%8B%A4%EB%A3%A8%EA%B8%B0/12-03.%20React%20%EC%83%81%ED%83%9C%20%EA%B4%80%EB%A6%AC/02.%20useReducer.md)ì˜ í´ë¦­ ì´ë²¤íŠ¸ reducer ì¬ì‚¬ìš©

